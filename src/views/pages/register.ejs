<html lang="en">
   <head>
      <%- include('../partials/head'); %>
      <link rel="stylesheet" href="/css/login.css" />
      <link rel="stylesheet" href="/css/signup.css" />
   </head>
   <body>
      <%- include('../partials/header') %>
      <div id="root">
         <div class="login signup">
            <div class="container">
               <div class="login-wrapper">
                  <div class="login-title">ƒêƒÉng k√Ω t√†i kho·∫£n</div>
                  <form id="form-register" action="/api/v1/auth/signup" method="post">
                     <div class="divider">
                        <div class="line"></div>
                        <div class="or">Th√¥ng tin c√° nh√¢n</div>
                     </div>
                     <div class="row form-container">
                        <div class="col-12">
                           <input
                              type="text"
                              class="input-feild"
                              placeholder="H·ªç v√† t√™n"
                              autocomplete="off"
                              name="fullName"
                              id="fullName"
                           />
                        </div>
                        <div class="col-12">
                           <input class="input-feild" placeholder="Email" id="email" type="email" name="email" />
                        </div>
                        <div class="col-12">
                           <input
                              class="input-feild"
                              placeholder="S·ªë ƒëi·ªán tho·∫°i"
                              id="phoneNumber"
                              type="text"
                              name="phoneNumber"
                           />
                        </div>
                        <div class="divider">
                           <div class="line"></div>
                           <div class="or">Th√¥ng tin t√†i kho·∫£n</div>
                        </div>
                        <div class="col-12">
                           <input
                              class="input-feild"
                              placeholder="T√™n ƒëƒÉng nh·∫≠p"
                              type="text"
                              id="userName"
                              name="userName"
                           />
                        </div>
                        <div class="col">
                           <input
                              class="input-feild"
                              placeholder="M·∫≠t kh·∫©u"
                              type="password"
                              id="password"
                              name="password"
                           />
                        </div>
                        <button type="submit" class="button button-full">REGISTER</button>
                     </div>
                  </form>
                  <div class="more-options">
                     <a href="/login" class="text--underline">ƒêƒÉng nh·∫≠p v·ªõi t√†i kho·∫£n c√≥ s·∫µn</a>
                     <a href="/" class="text--underline">Tr·ªü v·ªÅ c·ª≠a h√†ng</a>
                  </div>
               </div>
            </div>
         </div>
      </div>
      <%- include('../partials/footer') %> <%- include('../partials/foot'); %>
      <script type="module">
         import { getFormData } from '/js/utils/formDataHandler.js';
         const validate = new window.JustValidate('#form-register');
         validate
            .addField('#fullName', [
               {
                  rule: 'required',
                  errorMessage: 'Kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng h·ªç t√™n',
               },
               {
                  rule: 'minLength',
                  value: 3,
                  errorMessage: 'H·ªç v√† t√™n ph·∫£i c√≥ √≠t nh·∫•t 3 k√Ω t·ª±',
               },
               {
                  rule: 'maxLength',
                  value: 30,
                  errorMessage: 'H·ªç v√† t√™n ch·ªâ ƒë∆∞·ª£c c√≥ t·ªëi ƒëa 30 k√Ω t·ª±',
               },
            ])
            .addField('#email', [
               {
                  rule: 'required',
                  errorMessage: 'Kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng email !',
               },
               {
                  rule: 'email',
                  errorMessage: 'Kh√¥ng ƒë√∫ng ƒë·ªãnh d·∫°ng email !',
               },
            ])
            .addField('#phoneNumber', [
               {
                  rule: 'minLength',
                  value: 10,
                  errorMessage: 'S·ªë ƒëi·ªán tho·∫°i ph·∫£i c√≥ √≠t nh·∫•t 10 ch·ªØ s·ªë!',
               },
               {
                  rule: 'maxLength',
                  value: 12,
                  errorMessage: 'S·ªë ƒëi·ªán tho·∫°i ch·ªâ ƒë∆∞·ª£c c√≥ t·ªëi ƒëa 12 ch·ªØ s·ªë!',
               },
            ])
            .addField('#userName', [
               {
                  rule: 'required',
                  errorMessage: 'Vui l√≤ng ƒëi·ªÅn t√™n ƒëƒÉng nh·∫≠p !',
               },
               {
                  rule: 'minLength',
                  value: 6,
                  errorMessage: 'T√™n ƒëƒÉng nh·∫≠p ph·∫£i c√≥ √≠t nh·∫•t 6 k√Ω t·ª± !',
               },
               {
                  rule: 'maxLength',
                  value: 20,
                  errorMessage: 'T√™n ƒëƒÉng nh·∫≠p ch·ªâ ƒë∆∞·ª£c c√≥ nhi·ªÅu nh·∫•t 20 k√Ω t·ª± !',
               },
            ])
            .addField('#password', [
               {
                  rule: 'required',
                  errorMessage: 'Vui l√≤ng ƒëi·ªÅn m·∫≠t kh·∫©u !',
               },
               {
                  rule: 'password',
                  errorMessage: 'M·∫≠t kh·∫©u ph·∫£i c√≥ √≠t nh·∫•t 8 k√Ω t·ª±, trong ƒë√≥ c√≥ √≠t nh·∫•t m·ªôt k√Ω t·ª± ch·ªØ v√† m·ªôt k√Ω t·ª± s·ªë !',
               },
            ])
            .onSuccess(async (event) => {
               const formData = getFormData(event.target);
               try {
                  const { data, status } = await axios.post('/api/v1/auth/register', formData);
                  console.log('üöÄ ~ file: register.ejs ~ line 146 ~ status', status);
                  console.log('üöÄ ~ file: register.ejs ~ line 146 ~ data', data);
                  toastr.success('L∆∞u th√¥ng tin th√†nh c√¥ng !');
               } catch (error) {
                  toastr.error('X·∫£y ra l·ªói khi g·ª≠i request v·ªÅ server !', error);
               }
            });
      </script>
   </body>
</html>
